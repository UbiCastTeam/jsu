<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>

	<title>JSU test page</title>

	<script type="text/javascript" src="jsu.js"></script>

	<script type="text/javascript">
		function objectRepr(obj) {
			let repr = '';
			if (typeof obj == 'string') {
				repr = '\n  ' + obj
			} else {
				for (let field in obj) {
					repr += '\n  ' + field + ': ' + obj[field];
				}
			}
			if (!repr) {
				repr = '\nempty object'
			}
			repr = '[' + (typeof obj) + ':' + repr + '\n]';
			return repr;
		}

		function testTranslation() {
			const expected = 'test trad';
			jsu.addTranslations({'test label': expected});
			alert(
				'Current lang: ' + jsu.getCurrentLang() + '\n' +
				jsu.translate('test label') + '\n' +
				'Test: ' + (jsu.translate('test label') == expected ? 'OK' : 'FAIL')
			);
		}

		function testUserAgent() {
			// trigger internal user agent change
			const ua = document.getElementById('userAgent').value;
			if (ua) {
				jsu.userAgent = ua.toLowerCase();
				jsu._getBrowserInfo();
			}
			alert(
				'jsu.userAgent: ' + jsu.userAgent + '\n' +
				'jsu.osName: ' + jsu.osName + '\n' +
				'jsu.osVersion: ' + jsu.osVersion + '\n' +
				'jsu.browserName: ' + jsu.browserName + '\n' +
				'jsu.browserVersion: ' + jsu.browserVersion + '\n' +
				'jsu.browserVersion (type): ' + (typeof jsu.browserVersion) + '\n' +
				'jsu.isMobile: ' + jsu.isMobile + '\n' +
				'jsu.isTactile: ' + jsu.isTactile
			);
			return false;
		}

		function testWebGL() {
			alert('jsu.getWebglContext: ' + jsu.getWebglContext());
		}

		function testRequest(url, json) {
			jsu.httpRequest({
				url: url,
				json: json,
				callback: function (req, response) {
					alert(
						'req: ' + req + '\n' +
						'status: ' + req.status + '\n' +
						'response: ' + objectRepr(response)
					);
				}
			});
		}
	</script>
</head>

<body>
	<h1>JSU test page</h1>
	<p>
		<button type="button" onclick="testTranslation();">Test translations</button>
	</p>
	<p>
		<button type="button" onclick="testUserAgent();">Test user agent</button>
		<input type="text" name="userAgent" id="userAgent" style="width: 90%" placeholder="User agent to test (local user agent if empty)"/>
	</p>
	<p>
		<button type="button" onclick="testWebGL();">Test webgl</button>
	</p>
	<p>
		<button type="button" onclick="testRequest('https://localhost', true);">Test request on "https://localhost" as json</button>
		<button type="button" onclick="testRequest('https://localhost', false);">Test request on "https://localhost" as html</button>
		<button type="button" onclick="testRequest('nope', true);">Test request on "nope" as json</button>
		<button type="button" onclick="testRequest('nope', false);">Test request on "nope" as html</button>
	</p>
</body>
